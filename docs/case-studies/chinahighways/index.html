<!doctype html>
<html lang="zh" dir="ltr" class="mdx-wrapper mdx-page plugin-pages plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">China&#x27;s Highways ETC | GameOne IT CASS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://caitechs.github.io/gameone/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://caitechs.github.io/gameone/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://caitechs.github.io/gameone/case-studies/chinahighways/"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="China&#x27;s Highways ETC | GameOne IT CASS"><meta data-rh="true" name="description" content="KubeEdge-based system managing 100,000 Edge Nodes on China&#x27;s Highways Using KubeEdge"><meta data-rh="true" property="og:description" content="KubeEdge-based system managing 100,000 Edge Nodes on China&#x27;s Highways Using KubeEdge"><link data-rh="true" rel="canonical" href="https://caitechs.github.io/gameone/case-studies/chinahighways/"><link data-rh="true" rel="alternate" href="https://caitechs.github.io/gameone/case-studies/chinahighways/" hreflang="zh"><link data-rh="true" rel="alternate" href="https://caitechs.github.io/gameone/case-studies/chinahighways/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/gameone/blog/rss.xml" title="GameOne IT CASS RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/gameone/blog/atom.xml" title="GameOne IT CASS Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9PL5BPEXGS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9PL5BPEXGS",{anonymize_ip:!0})</script>






<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
<link rel="manifest" href="/favicons/site.webmanifest">
<meta name="theme-color" content="#ffffff">
<meta name="msapplication-config" content="/favicons/browserconfig.xml"><link rel="stylesheet" href="/gameone/assets/css/styles.20a47647.css">
<link rel="preload" href="/gameone/assets/js/runtime~main.dd112e5b.js" as="script">
<link rel="preload" href="/gameone/assets/js/main.83117b1d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/gameone/"><div class="navbar__logo"><img src="/gameone/img/avatar.png" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/gameone/img/avatar.png" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">GameOne 机器评分系统</b></a><a class="navbar__item navbar__link" target="_self" href="/gameone/docs">文档</a><a class="navbar__item navbar__link" target="_self" href="/gameone/blog">博客  </a><a class="navbar__item navbar__link" href="/gameone/partners">社区</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/caitechs/gameone" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link heade-icon"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/gameone/case-studies/chinahighways/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">中文</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><main class="container container--fluid margin-vert--lg"><div class="row mdxPageWrapper_j9I6"><div class="col col--8"><article><h1>Managing 100,000 Edge Nodes on China&#x27;s Highways Using KubeEdge</h1><p>This KubeEdge-based system for Electronic Toll Collection (ETC) manages nearly 100,000 edge nodes and more than 500,000 edge applications across 29 of China&#x27;s 34 provinces, cities and autonomous regions. With these applications, the system processes more than 300 million data records daily and supports continuous update of ETC services on highways. With this KubeEdge-based system, the traffic efficiency at the toll stations have improved by 10 times.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-background">Project Background<a href="#project-background" class="hash-link" aria-label="Project Background的直接链接" title="Project Background的直接链接">​</a></h2><p>More than 200 million drivers in China are now equipped with electronic toll collection (ETC) devices to pay automatically when driving on the country&#x27;s highways.</p><p>In order to improve the efficiency and compatibility of ETC systems on highways in China, Beijing Internet Zhilian Technology initiated a project to connect all ETC systems to one unified network and remove segregated, provincial toll stations. As a result, ETC gantries needed to be deployed on highways nationwide to collect license plate and transaction information when vehicles pass through toll booths.</p><p><img loading="lazy" alt="electronic-toll-booths" src="/gameone/assets/images/electronic-toll-booths-16d35217d2553970baf8b894071335a6.png" width="480" height="372" class="img_ev3q"></p><p>In this modernization project, nearly 100,000 gantries, controllers, and edge devices were deployed at the edge on highways. More than 500,000 applications were deployed on edge nodes to collect and upload information to provincial centers and Highway Monitoring &amp; Response Center through the toll collection private network.</p><p>The project faced the following challenges:</p><ul><li>Low quality network connections between centers and edge devices, with frequent delays, packet loss, and low bandwidth</li><li>Unified management of nearly 100,000 heterogeneous devices, including Arm and x86 devices</li><li>Lifecycle management of more than 500,000 applications</li></ul><p>After a comparative analysis of different architectures including cloud native and traditional ones, Beijing Internet Zhilian Technology selected a cloud-native based architecture proposed by Huawei, with KubeEdge as the key solution addressing the project&#x27;s problems.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-cloud-native">Why Cloud Native?<a href="#why-cloud-native" class="hash-link" aria-label="Why Cloud Native?的直接链接" title="Why Cloud Native?的直接链接">​</a></h2><p>In this project, the applications deployed at the edge are as complex as those in the cloud. For example, they comprise multiple microservices. Since Kubernetes is ideal for deploying and managing microservice applications at scale, the project had a goal to bring the benefits of Kubernetes to edge environments.</p><p>The project had the following typical deployment requirements:</p><ul><li>Hot standby</li><li>Multi-active mutual backup</li><li>Associated applications must be deployed on the same node to improve the interaction efficiency between applications.</li><li>Different instances of the same application must be deployed on different nodes to improve availability.</li><li>Applications must be deployed in different edge node groups based on the properties of edge nodes.</li><li>Application deployment should be defined as an independent object and also applications must be automatically deployed after new edge nodes that meet requirements are brought online.</li></ul><p>These requirements could be addressed by standard Kubernetes APIs, such as Deployments, ReplicaSets, and DaemonSets.</p><p>In addition, however, there were some requirements unique to the edge environment so that just using Kubernetes was not sufficient.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-kubeedge">Why KubeEdge?<a href="#why-kubeedge" class="hash-link" aria-label="Why KubeEdge?的直接链接" title="Why KubeEdge?的直接链接">​</a></h2><p>The project had two issues for its edge environment that standard Kubernetes could not address well:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="highly-complex-hardware-management-and-application-operations">Highly complex hardware management and application operations<a href="#highly-complex-hardware-management-and-application-operations" class="hash-link" aria-label="Highly complex hardware management and application operations的直接链接" title="Highly complex hardware management and application operations的直接链接">​</a></h4><p>Because they were deployed nationwide, the edge nodes in the ETC system were highly distributed, provided by multiple vendors, and span heterogeneous hardware architectures.</p><p>Some edge industrial computers were so small they only had a 1 quad-core ARM SoC and 1 GB memory. Thus, the ETC solution needed to use as few resources as possible to manage edge nodes.</p><p>Additionally, the ETC system included six different management layers for applications, starting from the Highway Monitoring &amp; Response Center out to the final road section. This could lead to complex operations and maintenance (O&amp;M) and high costs. The ETC solution needed to address these issues by simplifying edge setup, minimizing the probability of problem occurrences, and reducing O&amp;M costs.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="complex-and-unreliable-network-connectivity">Complex and unreliable network connectivity<a href="#complex-and-unreliable-network-connectivity" class="hash-link" aria-label="Complex and unreliable network connectivity的直接链接" title="Complex and unreliable network connectivity的直接链接">​</a></h4><p>The ETC network divides into two layers: one is from the Highway Monitoring &amp; Response Center to each provincial center, and the other is from each provincial center to toll stations on highways. A proxy server forwards data between the two layers.</p><p>Across these network layers and proxy, edge devices must be highly flexible and support multiple modes of access through private line, proxy, and public network, in either wired or wireless mode.</p><p>The network infrastructure varies significantly between each province. In some provinces, the network bandwidth is as low as 3 Mbit/s. The ETC solution must minimize the usage of the management network between the edge and cloud to fit within this low bandwidth. In addition, the network quality on some highways is very poor, which frequently causes network disconnections. The solution must have the ability to continue to operate offline in the case of network loss.</p><p>KubeEdge proved to be the ideal solution to address these issues. It provides both a highly lightweight edge engine to fit into small computers, as well as robust optimizations for the unstable network between the cloud and edge environments.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-overall-design">Project overall design<a href="#project-overall-design" class="hash-link" aria-label="Project overall design的直接链接" title="Project overall design的直接链接">​</a></h2><p>As shown below, the ETC project uses KubeEdge to manage large-scale edge nodes and a large number of services on the edge nodes from the cloud.</p><p><img loading="lazy" alt="kubeedge-edge-nodes-cloud" src="/gameone/assets/images/kubeedge-edge-nodes-cloud-44ec7fee3c2c0d434fcaba0705176330.png" width="576" height="454" class="img_ev3q"></p><p>The project provided a solution across three main areas:</p><ul><li>Application Deployment</li><li>Large-Scale Node Access</li><li>High Availability of Edge Services</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="application-deployment">Application Deployment<a href="#application-deployment" class="hash-link" aria-label="Application Deployment的直接链接" title="Application Deployment的直接链接">​</a></h2><p>The edge application services for the ETC system are as complex as any running in a cloud datacenter. They use cloud-native architecture and comprise multiple microservices. Additionally, they must also adapt to various heterogeneous hardware and operating systems, while still facilitating unified management.</p><p>As shown below, the microservice architecture consists of a front end and a back end. The front end deploys services on ETC gantries as Deployments and communicates with the back end through EdgeMesh. In this way, frontend and backend pods of microservices can communicate with each other. Redis and MySQL are deployed using StatefulSets. This deployment model perfectly encapsulates and automates the entire set of highly available systems at the edge.</p><p><img loading="lazy" alt="edgemesh-statefulsets" src="/gameone/assets/images/edgemesh-statefulsets-a6e99be1c460f23d3e5049ca8ea6a06c.png" width="439" height="554" class="img_ev3q"></p><p>However, the deployment model in the preceding figure could be applied to only one toll station at a time. In this project, a road section has hundreds or thousands of toll stations. It is labor-consuming to deploy these toll stations one by one. Therefore, a workflow engine system was constructed based on Kubernetes to define each step for deploying a microservice as a job. In this way, hundreds of thousands of identical microservice systems and environments can be rapidly deployed in batches.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="large-scale-node-access">Large-Scale Node Access<a href="#large-scale-node-access" class="hash-link" aria-label="Large-Scale Node Access的直接链接" title="Large-Scale Node Access的直接链接">​</a></h2><p>In addition to the challenge of application deployment, the ETC solution also addressed many other key issues:</p><ul><li>Each province was managing its own nodes. One Kubernetes cluster was configured for each province, and a unified management layer was deployed to process complex cross-cluster data, allowing the central site to manage the edge side of each province. This method is called multi-cluster management.</li><li>After a network upgrade was performed at the Highway Monitoring &amp; Response Center or a provincial center, all edge nodes in the provinces were disconnected from their Kubernetes clusters in case of a network failure. After the network recovers, all edge nodes would simultaneously connect to the Kubernetes cluster at the central side. A large number of concurrent connections would impact the system at the central site and cause application exceptions. Therefore, a dynamic back-off algorithm was used to relieve such impacts.</li><li>As mentioned earlier, the infrastructure varies in each province. The network bandwidth in some provinces was as low as 3 Mbit/s. Therefore, the information reported by NodeStatus and PodStatus was simplified to reduce the impact of data reporting on the network.</li></ul><p>Hierarchical acceleration of the container registry mirror effectively reduces the impact on the central site and improves the efficiency of large-scale deployment.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-availability-of-edge-services">High Availability of Edge Services<a href="#high-availability-of-edge-services" class="hash-link" aria-label="High Availability of Edge Services的直接链接" title="High Availability of Edge Services的直接链接">​</a></h2><p>The standard way to update Kubernetes applications in clouds is that the system deletes the pod of the old version, pulls the new image tag, and creates a new pod. This operation is acceptable when the cloud&#x27;s network is in good condition. However, in this ETC edge environment, services will be interrupted for a long time, and the toll data will be lost. Therefore, the application upgrade process was also optimized for this project.</p><p>The first optimization is to send a notification to instruct the edge node to pre-download the image of the new version. After the image is downloaded, the system deletes the old pod and starts the new application. In this way, the overall service interruption duration during the upgrade was shortened from minutes to less than 10 seconds, greatly reducing the impact on the services.</p><p>Edge devices are deployed in active/standby mode, but they cannot communicate with each other through services like Elastic Load Balance (ELB), a service deployed only in the cloud. To prevent single point of failures (SPOFs), Keepalived was configured for containers on edge nodes. In this way, the containers could provide services for cameras and other devices in the gantry systems through their virtual IP addresses (VIPs).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Summary的直接链接" title="Summary的直接链接">​</a></h2><p>The general deployment and scheduling model of Kubernetes is suitable for deployment of large-scale edge applications. KubeEdge, integrated with the Kubernetes cloud native management capability, provides better support for deployment and management of edge services.</p><p>This KubeEdge-based edge management system manages nearly 100,000 edge nodes and more than 500,000 edge applications across 29 of China&#x27;s 34 provinces, cities and autonomous regions. With these applications, the system processes more than 300 million data records daily and supports continuous update of ETC services on highways. Time used passing through toll station is reduced from 29s to 3s for trucks, and from 15s to 2s for cars.</p><p>This project also provides a platform for innovative services such as V2X and autonomous driving.</p><p>Huawei worked closely with Beijing Internet Zhilian Technology in this project to develop these optimizations for KubeEdge and Kubernetes and bring them back upstream into the CNCF open source community.</p></article></div><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#project-background" class="table-of-contents__link toc-highlight">Project Background</a></li><li><a href="#why-cloud-native" class="table-of-contents__link toc-highlight">Why Cloud Native?</a></li><li><a href="#why-kubeedge" class="table-of-contents__link toc-highlight">Why KubeEdge?</a></li><li><a href="#project-overall-design" class="table-of-contents__link toc-highlight">Project overall design</a></li><li><a href="#application-deployment" class="table-of-contents__link toc-highlight">Application Deployment</a></li><li><a href="#large-scale-node-access" class="table-of-contents__link toc-highlight">Large-Scale Node Access</a></li><li><a href="#high-availability-of-edge-services" class="table-of-contents__link toc-highlight">High Availability of Edge Services</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></main></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">2023 © GameOne Project Authors. All rights reserved. GameOne项目组，版权所有！</div></div></div></footer></div>
<script src="/gameone/assets/js/runtime~main.dd112e5b.js"></script>
<script src="/gameone/assets/js/main.83117b1d.js"></script>
</body>
</html>