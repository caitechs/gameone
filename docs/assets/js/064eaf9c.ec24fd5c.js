"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3383],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=a.createContext({}),p=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(i.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(t),m=r,g=d["".concat(i,".").concat(m)]||d[m]||u[m]||o;return t?a.createElement(g,l(l({ref:n},c),{},{components:t})):a.createElement(g,l({ref:n},c))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,l=new Array(o);l[0]=m;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s[d]="string"==typeof e?e:r,l[1]=s;for(var p=2;p<o;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},19713:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=t(83117),r=(t(67294),t(3905));const o={title:"\u4f7f\u7528EdgeMesh\u5b9e\u73b0\u8de8\u8fb9\u8fb9\u901a\u4fe1",sidebar_position:5},l=void 0,s={unversionedId:"advanced/edgemesh",id:"advanced/edgemesh",title:"\u4f7f\u7528EdgeMesh\u5b9e\u73b0\u8de8\u8fb9\u8fb9\u901a\u4fe1",description:"EdgeMesh as the data plane component of the KubeEdge cluster, provides simple service discovery and traffic proxy functions for applications, thereby shielding the complex network structure in edge scenarios.",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/advanced/edgemesh.md",sourceDirName:"advanced",slug:"/advanced/edgemesh",permalink:"/gameone/docs/advanced/edgemesh",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"\u4f7f\u7528EdgeMesh\u5b9e\u73b0\u8de8\u8fb9\u8fb9\u901a\u4fe1",sidebar_position:5},sidebar:"documentationSideBar",previous:{title:"\u83b7\u53d6\u8fb9\u7f18\u76d1\u63a7",permalink:"/gameone/docs/advanced/metrics"},next:{title:"Developer Guide",permalink:"/gameone/docs/category/developer-guide"}},i={},p=[{value:"Usage",id:"usage",level:2},{value:"Sample",id:"sample",level:2},{value:"Model",id:"model",level:2}],c={toc:p},d="wrapper";function u(e){let{components:n,...o}=e;return(0,r.kt)(d,(0,a.Z)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"EdgeMesh as the data plane component of the KubeEdge cluster, provides simple service discovery and traffic proxy functions for applications, thereby shielding the complex network structure in edge scenarios."),(0,r.kt)("p",null,"Check more details at ",(0,r.kt)("a",{parentName:"p",href:"https://edgemesh.netlify.app"},"edgemesh website")," to use EdgeMesh."),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("p",null,'Assume we have two edge nodes in ready state, we call them edge node "a" and "b":'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get nodes\nNAME          STATUS     ROLES    AGE   VERSION\nedge-node-a   Ready      edge     25m   v1.15.3-kubeedge-v1.1.0-beta.0.358+0b7ac7172442b5-dirty\nedge-node-b   Ready      edge     25m   v1.15.3-kubeedge-v1.1.0-beta.0.358+0b7ac7172442b5-dirty\nmaster        NotReady   master   8d    v1.15.0\n")),(0,r.kt)("p",null,"Deploy a sample pod from Cloud Side:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl apply -f https://raw.githubusercontent.com/kubeedge/kubeedge/master/build/deployment.yaml\ndeployment.apps/nginx-deployment created\n")),(0,r.kt)("p",null,"Check the pod is up and is running state, as we could see the pod is running on edge node b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get pods -o wide\nNAME                                READY   STATUS    RESTARTS   AGE   IP           NODE          NOMINATED NODE   READINESS GATES\nnginx-deployment-54bf9847f8-sxk94   1/1     Running   0          14m   172.17.0.2   edge-node-b   <none>           <none>\n")),(0,r.kt)("p",null,"Check if it works:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl 172.17.0.2\n<!DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!</title>\n<style>\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n</style>\n</head>\n<body>\n<h1>Welcome to nginx!</h1>\n<p>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.</p>\n\n<p>For online documentation and support please refer to\n<a href="https://nginx.org/">nginx.org</a>.<br/>\nCommercial support is available at\n<a href="https://nginx.com/">nginx.com</a>.</p>\n\n<p><em>Thank you for using nginx.</em></p>\n</body>\n</html>\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"172.17.0.2")," is the IP of deployment and the output may be different since the version of nginx image is different."),(0,r.kt)("p",null,"Then create a service for it:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"$ cat <<EOF | kubectl apply -f -\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-svc\n  namespace: default\nspec:\n  type: ClusterIP\n  selector:\n    app: nginx\n  ports:\n    - name: http-0\n      port: 12345\n      protocol: TCP\n      targetPort: 80\nEOF\n")),(0,r.kt)("blockquote",null,(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},'For L4/L7 proxy, specify what protocol a port would use by the port\'s "name". First HTTP port should be named "http-0" and the second one should be called "http-1", etc.'))),(0,r.kt)("p",null,"Check the service and endpoints:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get service\nNAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)     AGE\nnginx-svc    ClusterIP   10.96.191.183   <none>        12345/TCP   77m\n$ kubectl get endpoints\nNAME         ENDPOINTS            AGE\nnginx-svc    172.17.0.2:80        81m\n")),(0,r.kt)("p",null,"To request a server, use url like this: ",(0,r.kt)("inlineCode",{parentName:"p"},"<service_name>.<service_namespace>.svc.<cluster>.<local>:<port>")),(0,r.kt)("p",null,"In our case, from edge node a or b, run following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl http://nginx-svc.default.svc.cluster.local:12345\n<!DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!</title>\n<style>\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n</style>\n</head>\n<body>\n<h1>Welcome to nginx!</h1>\n<p>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.</p>\n\n<p>For online documentation and support please refer to\n<a href="https://nginx.org/">nginx.org</a>.<br/>\nCommercial support is available at\n<a href="https://nginx.com/">nginx.com</a>.</p>\n\n<p><em>Thank you for using nginx.</em></p>\n</body>\n</html>\n')),(0,r.kt)("blockquote",null,(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"EdgeMesh supports both Host Networking and Container Networking"),(0,r.kt)("li",{parentName:"ul"},"If you ever used EdgeMesh of old version, check your iptables rules. It might affect your test result."))),(0,r.kt)("h2",{id:"sample"},"Sample"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"sample",src:t(36065).Z,width:"1157",height:"323"})),(0,r.kt)("h2",{id:"model"},"Model"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"model",src:t(39020).Z,width:"1275",height:"594"})),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"One service"),(0,r.kt)("li",{parentName:"ol"},"One or more pods' labels match the service's selector"),(0,r.kt)("li",{parentName:"ol"},"To request a server, use: ",(0,r.kt)("inlineCode",{parentName:"li"},"<service_name>.<service_namespace>.svc.<cluster>:<port>"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"get the service's name and namespace from domain name"),(0,r.kt)("li",{parentName:"ul"},"query all the backend pods from MetaManager by service's namespace and name"),(0,r.kt)("li",{parentName:"ul"},"LoadBalance returns the real backend containers' hostIP and hostPort")))))}u.isMDXComponent=!0},36065:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/edgemesh-test-env-example-cbff27ec4766937ddf2ee06660af20c3.png"},39020:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/model-10a7e8d19d73920d4d97dcf9158f5281.jpg"}}]);