"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8331],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var r=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var i=r.createContext({}),u=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,i=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(n),m=s,g=d["".concat(i,".").concat(m)]||d[m]||c[m]||a;return n?r.createElement(g,l(l({ref:t},p),{},{components:n})):r.createElement(g,l({ref:t},p))}));function g(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,l=new Array(a);l[0]=m;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o[d]="string"==typeof e?e:s,l[1]=o;for(var u=2;u<a;u++)l[u]=n[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},99406:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>u});var r=n(83117),s=(n(67294),n(3905));const a={title:"\u8def\u7531\u7ba1\u7406",sidebar_position:3},l=void 0,o={unversionedId:"developer/custom_message_deliver",id:"developer/custom_message_deliver",title:"\u8def\u7531\u7ba1\u7406",description:"KubeEdge supports routing management with the help of Kubernetes CRDs and a router module.",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/developer/custom_message_deliver.md",sourceDirName:"developer",slug:"/developer/custom_message_deliver",permalink:"/docs/developer/custom_message_deliver",draft:!1,editUrl:"https://github.com/kubeedge/website/blob/master/docs/developer/custom_message_deliver.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"\u8def\u7531\u7ba1\u7406",sidebar_position:3},sidebar:"documentationSideBar",previous:{title:"Bluetooth Mapper E2E Test",permalink:"/docs/developer/test/bluetooth_mapper_e2e"},next:{title:"Mappers",permalink:"/docs/developer/mappers/"}},i={},u=[{value:"Usage scenarios",id:"usage-scenarios",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Rule And ruleendpoint Model",id:"rule-and-ruleendpoint-model",level:2},{value:"RuleEndpoint and Rule definition",id:"ruleendpoint-and-rule-definition",level:3},{value:"RuleEndpoint and Rule CRD design",id:"ruleendpoint-and-rule-crd-design",level:3},{value:"how to deliver custom messages",id:"how-to-deliver-custom-messages",level:3},{value:"Exception scenarios/Corner cases handling",id:"exception-scenarioscorner-cases-handling",level:2},{value:"CloudCore restart",id:"cloudcore-restart",level:3},{value:"Implementation plan",id:"implementation-plan",level:2}],p={toc:u},d="wrapper";function c(e){let{components:t,...n}=e;return(0,s.kt)(d,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"KubeEdge supports routing management with the help of Kubernetes ",(0,s.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#customresourcedefinitions"},"CRDs")," and a router module.\nUsers can deliver their custom messages between cloud and edge by mqtt broker."),(0,s.kt)("h2",{id:"usage-scenarios"},"Usage scenarios"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"used for user's control data delivery;"),(0,s.kt)("li",{parentName:"ul"},"not suitable for large data delivery;"),(0,s.kt)("li",{parentName:"ul"},"the data size of delivery at one time is limited to 12MB.")),(0,s.kt)("h2",{id:"use-cases"},"Use Cases"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"user can deliver custom message from cloud to edge by calling api in cloudcore. And it will deliver the message to mqttbroker on edge finally."),(0,s.kt)("ol",{parentName:"li"},(0,s.kt)("li",{parentName:"ol"},"user creates a rule which defines the message's source and target info."),(0,s.kt)("li",{parentName:"ol"},"user's app in cloud calls an api of cloudcore to deliver custom message; the message is delivered to edge, and published to mqttbroker with a topic."),(0,s.kt)("li",{parentName:"ol"},"user's app in edge subscribes the message with the same topic in step 2."))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"user can deliver custom message from edge to cloud by publishing message to mqttbroker. And it will deliver the message to rest api in cloud finally."),(0,s.kt)("ol",{parentName:"li"},(0,s.kt)("li",{parentName:"ol"},"user creates a rule which defines the message's source and target info."),(0,s.kt)("li",{parentName:"ol"},"user's app in edge published message to mqttbroker with a topic."),(0,s.kt)("li",{parentName:"ol"},"user's app in cloud got the message in step 2."))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"user can deliver custom message from cloud to edge by calling api in cloudcore. And it will call rest api on edgenode finally. And get the result."),(0,s.kt)("ol",{parentName:"li"},(0,s.kt)("li",{parentName:"ol"},"user creates a rule which defines the message's source and target info."),(0,s.kt)("li",{parentName:"ol"},"user's app in cloud calls an api of cloudcore to deliver custom message; cloudcore delivered the message to edgecore. Edgecore will call edge's rest api."),(0,s.kt)("li",{parentName:"ol"},"user's app in edge got the result of api call in step 2.")))),(0,s.kt)("h2",{id:"rule-and-ruleendpoint-model"},"Rule And ruleendpoint Model"),(0,s.kt)("h3",{id:"ruleendpoint-and-rule-definition"},"RuleEndpoint and Rule definition"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"A ruleEndpoint defines where messages come from, or where messages go to. It contains 3 types: rest, eventbus, servicebus."),(0,s.kt)("ol",{parentName:"li"},(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"rest"),": a rest endpoint in the cloud. It is a source ruleEndpoint to send rest requests to the edge. Or a target ruleEndpoint to receive message from edge.")),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"eventbus"),": It is a source ruleEndpoint to send data to the cloud, or a target ruleEndpoint to receive messages from the cloud. ")),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"servicebus"),":  a rest api on edge node. It is a target ruleEndpoint to receive messages delivered from cloud.")))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"Rule defines how messages were delivered from source ruleendpoint to target ruleendpoint. It contains 3 rule types."),(0,s.kt)("ol",{parentName:"li"},(0,s.kt)("li",{parentName:"ol"},"rest->eventbus: users' app calls rest api in cloud to send messages, finally  messages were sent to mqttbroker in edge."),(0,s.kt)("li",{parentName:"ol"},"eventbus->rest: users publish messages to mqttbroker in edge, finally messages were sent to rest api in cloud."),(0,s.kt)("li",{parentName:"ol"},"rest->servicebus: users' app calls rest api in cloud to send messages, finally  messages were sent to user's app in edge.")))),(0,s.kt)("h3",{id:"ruleendpoint-and-rule-crd-design"},"RuleEndpoint and Rule CRD design"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"RuleEndpoint")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: ruleendpoints.rules.kubeedge.io\nspec:\n  group: rules.kubeedge.io\n  versions:\n    - name: v1\n      served: true\n      storage: true\n      schema:\n        openAPIV3Schema:\n          type: object\n          properties:\n            spec:\n              type: object\n              properties:\n                ruleEndpointType:\n                  description: |\n                    ruleEndpointType is a string value representing rule-endpoint type. its value is\n                    one of rest/eventbus/servicebus.\n                  type: string\n                properties:\n                  description: |\n                    properties is not required except for servicebus rule-endpoint type. It is a map\n                    value representing rule-endpoint properties.when ruleEndpointType is servicebus,\n                    its value is {"service_port":"8080"}.\n                  type: object\n                  additionalProperties:\n                    type: string\n              required:\n                - ruleEndpointType\n  scope: Namespaced\n  names:\n    plural: ruleendpoints\n    singular: ruleendpoint\n    kind: RuleEndpoint\n    shortNames:\n      - re\n\n')),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Rule ")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: rules.rules.kubeedge.io\nspec:\n  group: rules.kubeedge.io\n  versions:\n    - name: v1\n      served: true\n      storage: true\n      schema:\n        openAPIV3Schema:\n          type: object\n          properties:\n            spec:\n              type: object\n              properties:\n                source:\n                  description: |\n                    source is a string value representing where the messages come from. Its\n                    value is the same with rule-endpoint name. For example, my-rest or my-eventbus.\n                  type: string\n                sourceResource:\n                  description: |\n                    sourceResource is a map representing the resource info of source. For rest\n                    rule-endpoint type its value is {"path":"/a/b"}. For eventbus rule-endpoint type its\n                    value is {"topic":"<user define string>","node_name":"edge-node"}\n                  type: object\n                  additionalProperties:\n                    type: string\n                target:\n                  description: |\n                    target is a string value representing where the messages go to. its value is\n                    the same with rule-endpoint name. For example, my-eventbus or my-rest or my-servicebus.\n                  type: string\n                targetResource:\n                  description: |\n                    targetResource is a map representing the resource info of target. For rest\n                    rule-endpoint type its value is {"resource":"http://127.0.0.1:8081/hello"}. For eventbus rule-endpoint\n                    type its value is {"topic":"/test"}. For servicebus rule-endpoint type its value is\n                    {"path":"/request_path"}.\n                  type: object\n                  additionalProperties:\n                    type: string\n              required:\n                - source\n                - sourceResource\n                - target\n                - targetResource\n            status:\n              type: object\n              properties:\n                successMessages:\n                  type: integer\n                failMessages:\n                  type: integer\n                errors:\n                  items:\n                    type: string\n                  type: array\n  scope: Namespaced\n  names:\n    plural: rules\n    singular: rule\n    kind: Rule\n\n')),(0,s.kt)("h3",{id:"how-to-deliver-custom-messages"},"how to deliver custom messages"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},'first, you should enable router module in cloudcore by modifying the cloudcore.yaml:\nadd "enable: true" in router module, and restart cloudcore.')),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"cloud to edge : ",(0,s.kt)("strong",{parentName:"p"},"rest->eventbus"),"\n1.1 create rest and eventbus type ruleEndpoint if they don't exist. Exec command:"),(0,s.kt)("p",{parentName:"li"}," ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-ruleEndpoint-rest.yaml")),(0,s.kt)("p",{parentName:"li"}," ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-ruleEndpoint-eventbus.yaml")))),(0,s.kt)("p",null,"create-ruleEndpoint-rest.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: RuleEndpoint\nmetadata:\n  name: my-rest\n  labels:\n    description: test\nspec:\n  ruleEndpointType: "rest"\n  properties: {}\n')),(0,s.kt)("p",null,"create-ruleEndpoint-eventbus.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: RuleEndpoint\nmetadata:\n  name: my-eventbus\n  labels:\n    description: test\nspec:\n  ruleEndpointType: "eventbus"\n  properties: {}\n')),(0,s.kt)("p",null,"1.2 create rule. Exec command:"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-rule-rest-eventbus.yaml")),(0,s.kt)("p",null,"create-rule-rest-eventbus.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: Rule\nmetadata:\n  name: my-rule\n  labels:\n    description: test\nspec:\n  source: "my-rest"\n  sourceResource: {"path":"/test"}\n  target: "my-eventbus"\n  targetResource: {"topic":"test"}\n')),(0,s.kt)("p",null,"1.3 call rest api in the cloud to send messages to edge."),(0,s.kt)("p",null,"The rest api in the cloud can be called to send messages to eventbus on an edge node based on the node name and sourceResource. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST"),(0,s.kt)("li",{parentName:"ul"},"URL: ",(0,s.kt)("strong",{parentName:"li"},"http://{rest_endpoint}/{node_name}/{namespace}/{path}"),", {rest_endpoint} is {cloudcore_ip}:9443, {node_name} is name of edgenode, {namespace} is the namespace of rule, {path}'s prefix is source ruleEndpoint's sourceResource."),(0,s.kt)("li",{parentName:"ul"},"Body: {user_message}, {user_message} is user's message")),(0,s.kt)("p",null,"For example:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST"),(0,s.kt)("li",{parentName:"ul"},"URL: http://{cloudcore_ip}:9443/{node_name}/default/test"),(0,s.kt)("li",{parentName:"ul"},'Body\uff1a {"message":"123"}')),(0,s.kt)("p",null,"1.4 User's app subscribes custom topics from mqtt-broker in edge to receive messages from the cloud. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Topic: {topic}, {topic} is target ruleEndpoint's targetResource."),(0,s.kt)("li",{parentName:"ul"},"Message:  {user_message}")),(0,s.kt)("p",null,"For example:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"subscribe Topic: 'test', exec command with mosquitto: ",(0,s.kt)("inlineCode",{parentName:"li"},"mosquitto_sub -t 'test' -d")),(0,s.kt)("li",{parentName:"ul"},'Get Message: {"message":"123"}')),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"edge to cloud: ",(0,s.kt)("strong",{parentName:"li"},"eventbus->rest"),":")),(0,s.kt)("p",null,"2.1 create rest type and eventbus type ruleEndpoint if they don't exist. Exec command:"),(0,s.kt)("p",null," ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-ruleEndpoint-rest.yaml")),(0,s.kt)("p",null," ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-ruleEndpoint-eventbus.yaml")),(0,s.kt)("p",null,"create-ruleEndpoint-rest.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: RuleEndpoint\nmetadata:\n  name: my-rest\n  labels:\n    description: test\nspec:\n  ruleEndpointType: "rest"\n  properties: {}\n')),(0,s.kt)("p",null,"create-ruleEndpoint-eventbus.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: RuleEndpoint\nmetadata:\n  name: my-eventbus\n  labels:\n    description: test\nspec:\n  ruleEndpointType: "eventbus"\n  properties: {}\n')),(0,s.kt)("p",null,"2.2 create rule. Exec command:"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-rule-eventbus-rest.yaml")),(0,s.kt)("p",null,"create-rule-eventbus-rest.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: Rule\nmetadata:\n  name: my-rule-eventbus-rest\n  labels:\n    description: test\nspec:\n  source: "my-eventbus"\n  sourceResource: {"topic": "test","node_name": "edge-node"}\n  target: "my-rest"\n  targetResource: {"resource":"http://127.0.0.1:8080/hello"}\n')),(0,s.kt)("p",null,"2.3 User's app in edge publishes messages with custom topic to MQTT broker on edge node. (target ruleEndpoint's targetResource ",(0,s.kt)("a",{parentName:"p",href:"http://127.0.0.1:8080/hello"},"http://127.0.0.1:8080/hello")," should be available before this step)"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Topic: {namespace}/{topic}"),(0,s.kt)("li",{parentName:"ul"},"Message:  {user_api_body}")),(0,s.kt)("p",null,"for example:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"publish data with mosquitto, exec command:"),(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"mosquitto_pub -t 'default/test' -d -m '{\"edgemsg\":\"msgtocloud\"}'")))),(0,s.kt)("p",null,"2.4 Kubeedge delivers messages to user api address in cloud. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST"),(0,s.kt)("li",{parentName:"ul"},"URL: ",(0,s.kt)("strong",{parentName:"li"},"http://{user_api}"),", or ",(0,s.kt)("strong",{parentName:"li"},"https://{user_api}"),", {user_api} is target ruleEndpoint's targetResource, for example ",(0,s.kt)("a",{parentName:"li",href:"http://127.0.0.1:8080/hello"},"http://127.0.0.1:8080/hello"),"."),(0,s.kt)("li",{parentName:"ul"},"Body: {user_api_body}")),(0,s.kt)("p",null,'For example: user\'s app in cloud gets the data {"edgemsg":"msgtocloud"}'),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"cloud to edge : ",(0,s.kt)("strong",{parentName:"li"},"rest->servicebus"))),(0,s.kt)("p",null,"3.1 create rest and servicebus type ruleEndpoint if they don't exist. Exec command:"),(0,s.kt)("p",null," ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-ruleEndpoint-rest.yaml")),(0,s.kt)("p",null," ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-ruleEndpoint-servicebus.yaml")),(0,s.kt)("p",null,"create-ruleEndpoint-rest.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: RuleEndpoint\nmetadata:\n  name: my-rest\n  labels:\n    description: test\nspec:\n  ruleEndpointType: "rest"\n  properties: {}\n')),(0,s.kt)("p",null,"create-ruleEndpoint-servicebus.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: RuleEndpoint\nmetadata:\n  name: my-servicebus\n  labels:\n    description: test\nspec:\n  ruleEndpointType: "servicebus"\n  properties: {"service_port":"6666"}\n')),(0,s.kt)("p",null,"3.2 create rule. Exec command:"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"kubectl create -f create-rule-rest-servicebus.yaml")),(0,s.kt)("p",null,"create-rule-rest-servicebus.yaml's contents are as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rules.kubeedge.io/v1\nkind: Rule\nmetadata:\n  name: my-rule-rest-servicebus\n  labels:\n    description: test\nspec:\n  source: "my-rest"\n  sourceResource: {"path":"/source"}\n  target: "my-servicebus"\n  targetResource: {"path":"/target"}\n')),(0,s.kt)("p",null,"3.3 user's app calls rest api in the cloud to send messages to edge."),(0,s.kt)("p",null,"The rest api in the cloud can be called to send messages to servicebus on an edge node based on the node name and sourceResource. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST/GET/DELETE/PUT"),(0,s.kt)("li",{parentName:"ul"},"URL: ",(0,s.kt)("strong",{parentName:"li"},"http://{rest_endpoint}/{node_name}/{namespace}/{path}"),", {rest_endpoint} is {cloudcore_ip}:9443, {node_name} is name of edgenode, {namespace} is namespace of rule. {path} is source ruleEndpoint's sourceResource."),(0,s.kt)("li",{parentName:"ul"},"Body: {user_message}, {user_message} is user's message")),(0,s.kt)("p",null,"finally, kubeedge's servicebus will call api on edgen node."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST/GET/DELETE/PUT"),(0,s.kt)("li",{parentName:"ul"},"URL: ",(0,s.kt)("strong",{parentName:"li"},(0,s.kt)("a",{parentName:"strong",href:"http://127.0.0.1:%7Bport%7D/%7Bpath%7D"},"http://127.0.0.1:{port}/{path}")),", {port} is target ruleEndpoint's properties, {path} is target ruleEndpoint's targetResource.  "),(0,s.kt)("li",{parentName:"ul"},"Body: {user_message}, {user_message} is user's message")),(0,s.kt)("p",null,"For example:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST"),(0,s.kt)("li",{parentName:"ul"},"URL: http://{cloudcore_ip}:9443/{node_name}/default/source"),(0,s.kt)("li",{parentName:"ul"},'Body\uff1a {"message":"123"}')),(0,s.kt)("p",null,"finnaly, kubeedge's servicebus calls api on edge node. For example:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Method: POST"),(0,s.kt)("li",{parentName:"ul"},"URL: ",(0,s.kt)("a",{parentName:"li",href:"http://127.0.0.1:6666/target"},"http://127.0.0.1:6666/target")),(0,s.kt)("li",{parentName:"ul"},'Body\uff1a {"message":"123"}')),(0,s.kt)("p",null,"user's app gets the result of the api on edge node."),(0,s.kt)("h2",{id:"exception-scenarioscorner-cases-handling"},"Exception scenarios/Corner cases handling"),(0,s.kt)("h3",{id:"cloudcore-restart"},"CloudCore restart"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"When cloudcore restarts or starts normally, it will get all rules from edge-controller, and store in memory.")),(0,s.kt)("h2",{id:"implementation-plan"},"Implementation plan"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Alpha: v1.6 rest->eventbus, eventbus->rest"),(0,s.kt)("li",{parentName:"ul"},"Beta: v1.7 rest->servicebus"),(0,s.kt)("li",{parentName:"ul"},"GA: TBD")))}c.isMDXComponent=!0}}]);